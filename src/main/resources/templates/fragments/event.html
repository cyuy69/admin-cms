<div th:fragment="content">
  <h2>活動管理</h2>
  <div class="tab-header">
    <button id="eventTabBtn" class="active">活動管理</button>
    <button id="ticketTabBtn">票種管理</button>
  </div>

  <section id="eventTab" class="tab-content">
    <h3>新增活動</h3>
    <form id="eventForm" th:action="@{/api/events/create}" method="post" enctype="multipart/form-data">
      <div>
        <label for="cover">活動封面：</label>
        <input type="file" id="cover" name="cover" accept="image/*" />
        <span id="coverFilename" style="margin-left: 10px; color: #555"></span>
        <br />
        <img id="coverPreview" style="max-width: 300px; margin-top: 10px; display: none" />
      </div>
      <div>
        <label for="title">活動名稱：</label>
        <input type="text" id="title" name="title" required />
      </div>
      <div>
        <label for="eventStart">活動開始日期：</label>
        <input type="datetime-local" id="eventStart" name="eventStart" required />
      </div>
      <div>
        <label for="eventEnd">活動結束日期：</label>
        <input type="datetime-local" id="eventEnd" name="eventEnd" required />
      </div>
      <div>
        <label for="ticketStart">售票日期：</label>
        <input type="datetime-local" id="ticketStart" name="ticketStart" required />
      </div>
      <div>
        <label for="address">活動地點：</label>
        <input type="text" id="address" name="address" required />
      </div>
      <div>
        <label for="description">活動描述：</label>
        <textarea id="description" name="description" rows="5"></textarea>
        <!-- TinyMCE 初始化在 JS 中處理 -->
      </div>
      <div class="dropdown-checkbox">
        <label>票種選擇：</label>
        <div class="dropdown">
          <button type="button" id="ticketDropdownToggleBtn">選擇票種 ▼</button>
          <div id="ticketDropdown" class="dropdown-content">
            <!-- JS 動態載入票種 -->
          </div>
        </div>
      </div>
      <div>
        <button type="button">預覽</button>
        <button type="submit">發佈活動</button>
        <button type="button" id="eventCancelBtn" style="display: none">
          取消
        </button>
      </div>
    </form>

    <h3>活動列表</h3>
    <div class="event-toolbar">
      <button id="sortCreateBtn" class="active">建立日期排序</button>
      <button id="sortEventBtn">活動日期排序</button>

      <input id="eventSearch" type="text" placeholder="搜尋活動" style="margin-left: auto" />
      <div id="pagination" style="margin-top: 15px"></div>
    </div>
    <div id="eventListContainer">
      <!-- AJAX 載入活動列表 -->
    </div>
  </section>

  <!-- 票種管理區塊 -->
  <section id="ticketTab" class="tab-content">
    <h3>票種管理</h3>
    <form id="ticketForm">
      <div>
        <label for="ticketName">票種名稱：</label>
        <input type="text" id="ticketName" name="ticketName" required />
      </div>
      <div>
        <label for="ticketPrice">票價：</label>
        <input type="number" id="ticketPrice" name="ticketPrice" required />
      </div>
      <div>
        <label for="isLimited">是否限量：</label>
        <select id="isLimited" name="isLimited">
          <option value="false">不限張數</option>
          <option value="true">限量</option>
        </select>
      </div>
      <div id="limitQuantityContainer" style="display: none">
        <label for="limitQuantity">限量張數：</label>
        <input type="number" id="limitQuantity" name="limitQuantity" />
      </div>
      <div>
        <label for="ticketDescription">說明：</label>
        <textarea id="ticketDescription" name="ticketDescription"></textarea>
      </div>
      <button type="submit">新增票種</button>
    </form>

    <!-- 系統模板區塊 -->
    <h4>票種模板</h4>
    <table border="1" cellspacing="0" cellpadding="6" style="width:100%; margin-bottom:20px;">
      <thead>
        <tr>
          <th>票種名稱</th>
          <th>票價</th>
          <th>限量？</th>
          <th>限量張數</th>
          <th>描述</th>
          <th>套用模板</th>
        </tr>
      </thead>
      <tbody id="templateTableBody"></tbody>
    </table>

    <!-- 主辦方自訂票種 -->
    <h4>我的自訂票種（可編輯/刪除）</h4>
    <table border="1" cellspacing="0" cellpadding="6" style="width:100%; margin-bottom:20px;">
      <thead>
        <tr>
          <th>#</th>
          <th>名稱</th>
          <th>票價</th>
          <th>限量？</th>
          <th>限量張數</th>
          <th>描述</th>
          <th>編輯</th>
          <th>刪除</th>
        </tr>
      </thead>
      <tbody id="customTableBody"></tbody>
    </table>
  </section>
</div>