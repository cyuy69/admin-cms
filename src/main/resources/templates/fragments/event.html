<div th:fragment="content">
  <div class="events-container">
    <h2 class="events-title">活動管理</h2>

    <div class="events-tab-header">
      <button id="eventTabBtn" class="events-tab-btn active">活動管理</button>
      <button id="ticketTabBtn" class="events-tab-btn">票種管理</button>
    </div>

    <section id="eventTab" class="events-tab-content" style="display: block">
      <div class="events-section">
        <h3 class="events-subtitle">新增/編輯活動</h3>
        <form
          id="eventForm"
          th:action="@{/api/events/create}"
          method="post"
          enctype="multipart/form-data"
        >
          <div class="events-form-group">
            <label class="events-label" for="cover">活動封面：</label>
            <input
              type="file"
              id="cover"
              name="cover"
              accept="image/*"
              class="events-input"
              style="border: none; padding-left: 0"
            />
            <span
              id="coverFilename"
              style="margin-left: 10px; color: #555"
            ></span>
            <br />
            <img
              id="coverPreview"
              class="events-cover-preview"
              style="
                max-width: 300px;
                margin-top: 10px;
                display: none;
                border-radius: 6px;
                border: 1px solid #eee;
              "
            />
          </div>

          <div class="events-form-group">
            <label class="events-label" for="title">活動名稱：</label>
            <input
              type="text"
              id="title"
              name="title"
              class="events-input"
              required
            />
          </div>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px">
            <div class="events-form-group">
              <label class="events-label">活動開始日期：</label>
              <div style="display: flex; gap: 10px">
                <input
                  type="date"
                  id="eventStartDate"
                  class="events-input"
                  required
                  style="flex: 2"
                />
                <select
                  id="eventStartHour"
                  class="events-select"
                  required
                  style="flex: 1"
                >
                  <option value="" disabled selected>時</option>
                </select>
              </div>
              <input type="hidden" id="eventStart" name="eventStart" />
            </div>

            <div class="events-form-group">
              <label class="events-label">活動結束日期：</label>
              <div style="display: flex; gap: 10px">
                <input
                  type="date"
                  id="eventEndDate"
                  class="events-input"
                  required
                  style="flex: 2"
                />
                <select
                  id="eventEndHour"
                  class="events-select"
                  required
                  style="flex: 1"
                >
                  <option value="" disabled selected>時</option>
                </select>
              </div>
              <input type="hidden" id="eventEnd" name="eventEnd" />
            </div>
          </div>

          <div class="events-form-group">
            <label class="events-label">售票日期：</label>
            <div style="display: flex; gap: 10px">
              <input
                type="date"
                id="ticketStartDate"
                class="events-input"
                required
                style="flex: 2"
              />
              <select
                id="ticketStartHour"
                class="events-select"
                required
                style="flex: 1"
              >
                <option value="" disabled selected>時</option>
              </select>
            </div>
            <input type="hidden" id="ticketStart" name="ticketStart" />
          </div>

          <div class="events-form-group">
            <label class="events-label" for="address">活動地點：</label>
            <input
              type="text"
              id="address"
              name="address"
              class="events-input"
              required
            />
          </div>

          <div class="events-form-group">
            <label class="events-label" for="description">活動描述：</label>
            <textarea
              id="description"
              name="description"
              rows="5"
              class="events-textarea"
            ></textarea>
          </div>

          <div class="events-form-group">
            <label class="events-label">票種選擇：</label>
            <button
              type="button"
              id="ticketDropdownToggleBtn"
              class="events-btn events-btn-secondary"
              style="
                width: 100%;
                text-align: left;
                justify-content: space-between;
              "
            >
              選擇票種 <span style="font-size: 12px">▼</span>
            </button>
            <div
              id="ticketDropdown"
              style="
                display: none;
                margin-top: 10px;
                border: 1px solid #eee;
                padding: 10px;
                border-radius: 6px;
              "
            ></div>
          </div>

          <div
            style="
              margin-top: 20px;
              display: flex;
              gap: 10px;
              justify-content: center;
            "
          >
            <button type="submit" class="events-btn events-btn-primary">
              發佈活動
            </button>
            <button
              type="button"
              id="eventCancelBtn"
              class="events-btn events-btn-danger"
              style="display: none"
            >
              取消
            </button>
          </div>
        </form>
      </div>

      <div class="events-section">
        <h3 class="events-subtitle">活動列表</h3>
        <div class="events-toolbar">
          <div>
            <button
              id="sortCreateBtn"
              class="events-btn events-btn-secondary active"
            >
              建立日期排序
            </button>
            <button id="sortEventBtn" class="events-btn events-btn-secondary">
              活動日期排序
            </button>
          </div>
          <input
            id="eventSearch"
            type="text"
            class="events-search-input"
            placeholder="搜尋活動"
          />
        </div>

        <div id="eventListContainer"></div>
        <div
          id="eventPagination"
          class="events-pagination"
          style="margin-top: 15px; justify-content: center"
        ></div>
      </div>
    </section>

    <section id="ticketTab" class="events-tab-content">
      <div class="events-section">
        <h3 class="events-subtitle">新增票種</h3>
        <form id="ticketForm">
          <div class="events-form-group">
            <label class="events-label" for="ticketName">票種名稱：</label>
            <input
              type="text"
              id="ticketName"
              name="ticketName"
              class="events-input"
              required
            />
          </div>
          <div class="events-form-group">
            <label class="events-label" for="ticketPrice">票價：</label>
            <input
              type="number"
              id="ticketPrice"
              name="ticketPrice"
              class="events-input"
              required
            />
          </div>
          <div class="events-form-group">
            <label class="events-label" for="isLimited">是否限量：</label>
            <select id="isLimited" name="isLimited" class="events-select">
              <option value="false">不限張數</option>
              <option value="true">限量</option>
            </select>
          </div>
          <div
            id="limitQuantityContainer"
            class="events-form-group"
            style="display: none"
          >
            <label class="events-label" for="limitQuantity">限量張數：</label>
            <input
              type="number"
              id="limitQuantity"
              name="limitQuantity"
              class="events-input"
            />
          </div>
          <div class="events-form-group">
            <label class="events-label" for="ticketDescription">說明：</label>
            <textarea
              id="ticketDescription"
              name="ticketDescription"
              class="events-textarea"
            ></textarea>
          </div>
          <div
            style="
              margin-top: 20px;
              display: flex;
              gap: 10px;
              justify-content: center;
            "
          >
            <button type="submit" class="events-btn events-btn-primary">
              新增票種
            </button>
            <button
              type="button"
              id="ticketCancelBtn"
              class="events-btn events-btn-danger"
              style="display: none"
              onclick="cancelEditTicket(this)"
            >
              取消
            </button>
          </div>
        </form>
      </div>

      <div class="events-section">
        <h4 class="events-subtitle">系統票種模板</h4>
        <div style="overflow-x: auto">
          <table class="events-table">
            <thead>
              <tr>
                <th>票種名稱</th>
                <th>票價</th>
                <th>限量？</th>
                <th>限量張數</th>
                <th>描述</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody id="templateTableBody"></tbody>
          </table>
        </div>
      </div>

      <div class="events-section">
        <h4 class="events-subtitle">我的自訂票種</h4>
        <div style="overflow-x: auto">
          <table class="events-table">
            <thead>
              <tr>
                <th>#</th>
                <th>名稱</th>
                <th>票價</th>
                <th>限量？</th>
                <th>限量張數</th>
                <th>描述</th>
                <th>編輯</th>
                <th>刪除</th>
              </tr>
            </thead>
            <tbody id="customTableBody"></tbody>
          </table>
        </div>
      </div>
    </section>
  </div>
</div>
